ROSTemplateFormatVersion: '2015-09-01'
Description:
  en: 'Alibaba Cloud ROS Sample Template: Create a VPC type memcache instance.'
  zh-cn: 阿里云资源编排示例模板： 创建一个 VPC类型 memcache 实例。
Parameters:
  ZoneId:
    Type: String
    Label:
      en: Zone ID
      zh-cn: 可用区
    Description:
      zh-cn: 创建实例的可用区，确保可用区支持Memcache资源规格的创建。
      en: Create an Availability Zone for an instance to ensure that the Availability
        Zone supports the creation of Memcache resource specifications.
    AssociationProperty: ALIYUN::ECS::Instance::ZoneId
  InstanceClass:
    Type: String
    Label:
      zh-cn: 实例规格
      en: Instance Type
    Description:
      en: Instance specifications, please refer to the Alibaba Cloud Memcache product
        website documentation or online consultation.
      zh-cn: 实例规格，请参考：<a href='https://help.aliyun.com/document_detail/95169.html'
        target='_blank'><b><font color='blue'>查看规格信息</font></b></a>
    Default: memcache.master.small.default
  Password:
    Type: String
    Label:
      en: Instance Password
      zh-cn: 实例密码
    Description:
      en: 'Length 8-32 characters, can contain size letters, Numbers and special symbols,
        including: !@#$%^&*()_+-='
      zh-cn: 长度8-32个字符,可包含大小字母、数字及特殊符号（包含：!@#$%^&*()_+-=）
    ConstraintDescription:
      en: '8-32 characters, can contain size letters, Numbers and special symbols,
        including: !@#$%^&*()_+-='
      zh-cn: 8-32个字符,可包含大小字母、数字及特殊符号（包含：!@#$%^&*()_+-=）
    MinLength: 8
    MaxLength: 32
    NoEcho: true
Resources:
  EcsVpc:
    Type: ALIYUN::ECS::VPC
    Properties:
      CidrBlock: 192.168.0.0/16
    Metadata:
      ALIYUN::ROS::Designer:
        id: d6c1fa46-58c0-40cb-a4d0-fef3a66e32f9
  EcsVSwitch:
    Type: ALIYUN::ECS::VSwitch
    Properties:
      ZoneId:
        Ref: ZoneId
      VpcId:
        Ref: EcsVpc
      CidrBlock: 192.168.10.0/24
    DependsOn: EcsVpc
    Metadata:
      ALIYUN::ROS::Designer:
        id: 7e719752-efc5-48b2-b7b5-70bbc8ebf6a5
  MemcacheInstance:
    Type: ALIYUN::Memcache::Instance
    Properties:
      ZoneId:
        Ref: ZoneId
      VpcId:
        Ref: EcsVpc
      VSwitchId:
        Ref: EcsVSwitch
      InstanceClass:
        Ref: InstanceClass
      NetworkType: VPC
      Password:
        Ref: Password
    DependsOn: EcsVSwitch
    Metadata:
      ALIYUN::ROS::Designer:
        id: e7c860fc-19cb-49d4-bb6d-c29efe5b4378
Outputs:
  ConnectionDomain:
    Description: Intranet connection string
    Value:
      Fn::GetAtt:
      - MemcacheInstance
      - ConnectionDomain
  InstanceId:
    Value:
      Fn::GetAtt:
      - MemcacheInstance
      - InstanceId
  QPS:
    Value:
      Fn::GetAtt:
      - MemcacheInstance
      - QPS
  Port:
    Value:
      Fn::GetAtt:
      - MemcacheInstance
      - Port
Metadata:
  ALIYUN::ROS::Interface:
    ParameterGroups:
    - Parameters:
      - ZoneId
      - InstanceClass
      - Password
      Label:
        default: Memcache
    TemplateTags:
    - acs:example:数据库:创建云数据库Memcache版实例
  ALIYUN::ROS::Designer:
    d6c1fa46-58c0-40cb-a4d0-fef3a66e32f9:
      size:
        width: 311
        height: 261
      position:
        x: 40
        y: 117
      z: 0
      embeds:
      - 7e719752-efc5-48b2-b7b5-70bbc8ebf6a5
    7e719752-efc5-48b2-b7b5-70bbc8ebf6a5:
      size:
        width: 201
        height: 169
      position:
        x: 98
        y: 163
      z: 1
      embeds:
      - e7c860fc-19cb-49d4-bb6d-c29efe5b4378
    e7c860fc-19cb-49d4-bb6d-c29efe5b4378:
      size:
        width: 60
        height: 60
      position:
        x: 172
        y: 223
      z: 2
