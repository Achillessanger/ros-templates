ROSTemplateFormatVersion: '2015-09-01'
Description: Create ECS Ram Role
Parameters:
  RoleName:
    Type: String
    Label:
      zh-cn: Ram角色名
      en: RoleName
    Description:
      zh-cn: Ram角色名称，长度为1-64个字符，以英文字母或数字开头，允许使用连字符，账号内唯一。
      en: Ram role name, 1 to 64 characters in length, beginning with English letters
        or numbers, hyphens allowed, unique in the account.
    ConstraintDescription:
      zn-cn: 长度为1-64个字符，以英文字母或数字开头，允许使用连字符。
      en: 1 to 64 characters in length, beginning with English letters or numbers,
        hyphens allowed.
    Default: EcsRamRoleDocumentTesting
    MinLength: 1
    MaxLength: 64
  PolicyAction:
    Type: Json
    Label:
      zh-cn: 操作
      en: Action
    Description:
      zh-cn: 授权给RAM角色的策略允许的操作。
      en: Operations allowed by the policy granted to the RAM role.
    Default:
    - oss:Get*
    - oss:List*
Resources:
  ECSRole:
    Type: ALIYUN::RAM::Role
    Properties:
      RoleName:
        Ref: RoleName
      AssumeRolePolicyDocument:
        Statement:
        - Action: sts:AssumeRole
          Effect: Allow
          Principal:
            Service:
            - ecs.aliyuncs.com
        Version: '1'
      Policies:
      - PolicyName:
          Fn::Sub: EcsRamRolePolicy-${ALIYUN::StackId}
        PolicyDocument:
          Version: '1'
          Statement:
          - Effect: Allow
            Action:
              Ref: PolicyAction
            Resource:
            - '*'
Outputs:
  Arn:
    Value:
      Fn::GetAtt:
      - ECSRole
      - Arn
  RoleName:
    Value:
      Fn::GetAtt:
      - ECSRole
      - RoleName
Metadata:
  ALIYUN::ROS::Interface:
    ParameterGroups:
    - Parameters:
      - RoleName
      - PolicyAction
      Label:
        default: RAM
    TemplateTags:
    - acs:example:安全:ECS实例RAM角色
