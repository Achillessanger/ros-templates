ROSTemplateFormatVersion: '2015-09-01'
Description: Create a sub-account to grant RAM Role
Parameters:
  UserName:
    Type: String
    Label:
      en: User Name
      zh-cn: 用户名
    Description:
      en: Consists of 1-128 English letters, numbers, ".", "_", Or "-", unique in
        the account
      zh-cn: 由1-128个英文字母、数字、“.”、“_”或“-”组成，账号内唯一。
    Default: TestPassRole
  Service:
    Type: String
    Label:
      en: Trusted Service
      zh-cn: 授信服务
    Description:
      en: Trusted Service Address
      zh-cn: 授信服务地址
    Default: oos.aliyuncs.com
  Resource:
    Type: Json
    Label:
      en: Credit Role
      zh-cn: 授信角色
    Description:
      en: Credit for role Arn, "*" for all RAM roles
      zh-cn: 授信角色的Arn，“*”表示授信给所有RAM角色
    Default:
    - '*'
Resources:
  User:
    Type: ALIYUN::RAM::User
    Properties:
      Policies:
      - PolicyDocument:
          Statement:
          - Action:
            - ram:PassRole
            Condition:
              StringEquals:
                acs:Service:
                  Ref: Service
            Effect: Allow
            Resource:
              Ref: Resource
          Version: '1'
        PolicyName:
          Fn::Sub: PassRole-${ALIYUN::StackId}
      UserName:
        Ref: UserName
Outputs:
  UserName:
    Value:
      Fn::GetAtt:
      - User
      - UserName
Metadata:
  ALIYUN::ROS::Interface:
    ParameterGroups:
    - Parameters:
      - UserName
      - Service
      - Resource
      Label:
        default: RAM
    TemplateTags:
    - acs:example:安全:子账户PassRole权限
